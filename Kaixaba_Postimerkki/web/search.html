<!DOCTYPE html>
<html>
<head>
    <title>
        Search
    </title>
    <meta charset="UTF-8" />
    <style media="screen"></style>
    <script></script>
    
   
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        
    <link rel="stylesheet" type="text/css" href="css/fPage.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/jquery@3.2.1"></script>
</head>

<body>

<div id="root"></div>
<script type="text/babel">
class StampForm extends React.Component {
  constructor(props) {
    super(props);
    this.state = {value: ''};
    this.state = {data: ["asd"]}
    this.handleChange = this.handleChange.bind(this);
    this.handleSubmit = this.handleSubmit.bind(this);
  }


  handleChange(event) {
    this.setState({value: event.target.value});
  }

  getInitialState(){
        return{
            data:[]
        };
    }

    showResult(response) {

            this.setState({
                data: response
            });
    }


  getDataFromServer(URL){
  var frm = $(document.myform);
    var data = getFormData(frm);
        $.ajax({
            type:"POST",
            dataType:"json",
            url: URL,
            data: JSON.stringify(data),
            success: function(response) {
                this.showResult(response);
            }.bind(this),
            error: function(xhr, status, err) {
                console.error(this.props.url, status, err.toString());
            }.bind(this)
        });
    }


  handleSubmit(event) {
    event.preventDefault();
    this.getDataFromServer('http://localhost:8080/Kaixaba_Postimerkki/SearchStamps');
    var frm = $(document.myform);
    var data = getFormData(frm);
    }





  render() {
    return (
    <div>
      <form onSubmit={this.handleSubmit} name="myform">
          Color:<br/>
          <input type="text" name="color" defaultValue=""/>
          <br/>
          Release Date:<br/>
          <input type="text" name="releaseDate" defaultValue=""/>
          <br/>
          End Date:<br/>
          <input type="text" name="endDate" defaultValue=""/>
          <br/>
          Value:<br/>
          <input type="text" name="value" defaultValue=""/>
          <br/>
          Name:<br/>
          <input type="text" name="name" defaultValue=""/>
          <br/>
          Print Location:<br/>
          <input type="text" name="printLocation" defaultValue=""/>
          <br/>
          Print Amount:<br/>
          <input type="text" name="printAmount" defaultValue=""/>
          <br/>
          Artist:<br/>
          <input type="text" name="artist" defaultValue=""/>
          <br/>
          Currency:<br/>
          <input type="text" name="currency" defaultValue=""/>
          <br/>
        <input type="submit" value="Submit" />
      </form>
      
      <Result result={this.state.data}/>
      
      </div>
    );
  }
}

function getFormData($form){
    var unindexed_array = $form.serializeArray();
    var indexed_array = {};

    $.map(unindexed_array, function(n, i){
        indexed_array[n['name']] = n['value'];
    });

    return indexed_array;
}


var Result = React.createClass({
    render:function(){
        var result = this.props.result.map(function(result,index){
            return <ResultItem key={index} user={ result } />
            });
        return(
            <div className="container">
                <div className="row">
                    {result}
                </div>
            </div>
        );
    }
});

var ResultItem = React.createClass({
    render:function(){
        var camper = this.props.user;
        return(
            <div className="col-xs-6 col-sm-4 col-md-3">
            <div className="stamp">
            <div className="col-xs-12"><h3>{camper.name}</h3></div>
                <div className="col-xs-12"><img src={camper.url} /></div>
                <div className="col-xs-12"><p>Ilmestynyt:&nbsp;{camper.releaseDate}</p></div>
                <div className="col-xs-12"><p>Poistunut:&nbsp;{camper.endDate}</p></div>
                <div className="col-xs-12"><p>V채ri:&nbsp;{camper.color}</p></div>
                <div className="col-xs-12"><p>Nimellisarvo:&nbsp;{camper.value}</p></div>
                <div className="col-xs-12"><p>Painopaikka:&nbsp;{camper.printLocation}</p></div>
                <div className="col-xs-12"><p>Painom채채r채:&nbsp;{camper.printAmount}</p></div>
                <div className="col-xs-12"><p>Valuutta:&nbsp;{camper.currency}</p></div>
                <div className="col-xs-12"><p>Taiteilija:&nbsp;{camper.artist}</p></div>


            </div>
            </div>
        );
    }
});


ReactDOM.render(
            <StampForm/>,
            document.getElementById('root')
        );

</script>



<p>If you click the "Submit" button, the form-data will be sent to a function called handleSubmit.</p>

</body>
</html>